{
  "metadata": {
    "project_name": "CookieCloud",
    "description": "CookieCloud 服务端接口 Go 语言实现版本",
    "language": "Go",
    "version": "1.0.0",
    "last_scan": "2026-01-11T16:25:37+08:00",
    "scanner_version": "1.0.0"
  },
  "scan_statistics": {
    "total_files_estimated": 45,
    "source_files": 7,
    "scanned_files": 7,
    "coverage_percent": 100,
    "ignored_files": 38,
    "test_files": 0,
    "truncated": false
  },
  "modules": [
    {
      "name": "cmd/cookiecloud",
      "path": "cmd/cookiecloud",
      "type": "entry",
      "language": "Go",
      "description": "应用启动与路由注册",
      "entry_point": "cmd/cookiecloud/main.go",
      "has_tests": false,
      "has_config": false,
      "coverage": 100,
      "interfaces": [
        {
          "type": "http",
          "description": "HTTP 服务器启动",
          "port": "8088",
          "endpoints": [
            "GET/POST /",
            "POST /update",
            "GET/POST /get/:uuid"
          ]
        }
      ],
      "dependencies": [
        "internal/handlers",
        "internal/storage",
        "github.com/gofiber/fiber/v2",
        "github.com/gofiber/fiber/v2/middleware/cors"
      ],
      "environment_variables": [
        {
          "name": "PORT",
          "default": "8088",
          "description": "HTTP 服务监听端口"
        },
        {
          "name": "API_ROOT",
          "default": "",
          "description": "API 根路径"
        }
      ],
      "gaps": [
        "缺少单元测试",
        "缺少优雅关闭机制",
        "缺少健康检查端点"
      ]
    },
    {
      "name": "internal/handlers",
      "path": "internal/handlers",
      "type": "handler",
      "language": "Go",
      "description": "HTTP 请求处理与响应",
      "entry_point": "internal/handlers/handlers.go",
      "has_tests": false,
      "has_config": false,
      "coverage": 100,
      "interfaces": [
        {
          "type": "function",
          "name": "FiberRootHandler",
          "signature": "func FiberRootHandler(apiRoot string) fiber.Handler",
          "description": "根路径处理器，返回欢迎信息"
        },
        {
          "type": "function",
          "name": "FiberUpdateHandler",
          "signature": "func FiberUpdateHandler(c *fiber.Ctx) error",
          "description": "处理更新请求，保存加密数据"
        },
        {
          "type": "function",
          "name": "FiberGetHandler",
          "signature": "func FiberGetHandler(c *fiber.Ctx) error",
          "description": "处理获取数据请求，支持解密"
        }
      ],
      "dependencies": [
        "internal/crypto",
        "internal/storage",
        "github.com/gofiber/fiber/v2"
      ],
      "data_models": [
        {
          "name": "UpdateRequest",
          "fields": [
            {"name": "UUID", "type": "string", "json": "uuid"},
            {"name": "Encrypted", "type": "string", "json": "encrypted"}
          ]
        },
        {
          "name": "DecryptRequest",
          "fields": [
            {"name": "Password", "type": "string", "json": "password"}
          ]
        }
      ],
      "gaps": [
        "缺少单元测试",
        "缺少请求参数验证（如 UUID 格式）",
        "缺少速率限制",
        "缺少请求日志记录"
      ]
    },
    {
      "name": "internal/storage",
      "path": "internal/storage",
      "type": "storage",
      "language": "Go",
      "description": "数据持久化与文件操作",
      "entry_point": "internal/storage/storage.go",
      "has_tests": false,
      "has_config": false,
      "coverage": 100,
      "interfaces": [
        {
          "type": "function",
          "name": "InitDataDir",
          "signature": "func InitDataDir() error",
          "description": "初始化数据目录"
        },
        {
          "type": "function",
          "name": "SaveEncryptedData",
          "signature": "func SaveEncryptedData(uuid, encrypted string) error",
          "description": "保存加密数据到文件"
        },
        {
          "type": "function",
          "name": "LoadEncryptedData",
          "signature": "func LoadEncryptedData(uuid string) (*CookieData, error)",
          "description": "从文件加载加密数据"
        }
      ],
      "dependencies": [
        "encoding/json",
        "os",
        "path/filepath"
      ],
      "data_models": [
        {
          "name": "CookieData",
          "fields": [
            {"name": "Encrypted", "type": "string", "json": "encrypted"}
          ]
        }
      ],
      "storage_type": "JSON Files",
      "storage_path": "./data",
      "gaps": [
        "缺少单元测试",
        "缺少并发写入保护",
        "缺少数据备份机制",
        "缺少数据删除功能",
        "缺少缓存机制"
      ]
    },
    {
      "name": "internal/crypto",
      "path": "internal/crypto",
      "type": "crypto",
      "language": "Go",
      "description": "加密解密算法实现",
      "entry_point": "internal/crypto/crypto.go",
      "has_tests": false,
      "has_config": false,
      "coverage": 100,
      "interfaces": [
        {
          "type": "function",
          "name": "Decrypt",
          "signature": "func Decrypt(uuid, encrypted, password string) []byte",
          "description": "解密 Cookie 数据（兼容 CryptoJS）"
        }
      ],
      "dependencies": [
        "crypto/aes",
        "crypto/cipher",
        "crypto/md5",
        "encoding/base64",
        "encoding/hex"
      ],
      "algorithms": [
        "AES-256-CBC",
        "EVP_BytesToKey (OpenSSL)",
        "PKCS7 Padding",
        "MD5 Hash"
      ],
      "gaps": [
        "缺少单元测试",
        "缺少加密功能（仅有解密）",
        "缺少完整性校验（HMAC）",
        "使用 MD5（已不推荐）",
        "密钥长度仅 16 字节（AES-128）"
      ]
    }
  ],
  "dependencies": {
    "go": {
      "version": "1.25.5",
      "modules": [
        {
          "path": "github.com/gofiber/fiber/v2",
          "version": "v2.52.10"
        }
      ],
      "indirect": [
        "github.com/andybalholm/brotli",
        "github.com/google/uuid",
        "github.com/klauspost/compress",
        "github.com/mattn/go-colorable",
        "github.com/mattn/go-isatty",
        "github.com/mattn/go-runewidth",
        "github.com/rivo/uniseg",
        "github.com/valyala/bytebufferpool",
        "github.com/valyala/fasthttp",
        "github.com/valyala/tcplisten",
        "golang.org/x/sys"
      ]
    }
  },
  "configuration_files": [
    {
      "path": "Dockerfile",
      "type": "docker",
      "description": "多阶段 Docker 构建配置"
    },
    {
      "path": ".github/workflows/docker-image.yml",
      "type": "github_actions",
      "description": "CI/CD Docker 镜像构建流程"
    },
    {
      "path": ".gitignore",
      "type": "git",
      "description": "Git 忽略规则"
    }
  ],
  "ignore_rules": [
    "node_modules/**",
    "data/**",
    ".git/**",
    ".github/**",
    "dist/**",
    "build/**",
    ".next/**",
    "__pycache__/**",
    "*.lock",
    "*.log",
    "*.bin",
    "*.pdf",
    "*.png",
    "*.jpg",
    "*.jpeg",
    "*.gif",
    "*.mp4",
    "*.zip",
    "*.tar",
    "*.gz"
  ],
  "ignored_paths": [
    ".git/",
    "node_modules/",
    "data/"
  ],
  "documentation": {
    "root": "CLAUDE.md",
    "modules": [
      "cmd/cookiecloud/CLAUDE.md",
      "internal/handlers/CLAUDE.md",
      "internal/storage/CLAUDE.md",
      "internal/crypto/CLAUDE.md"
    ],
    "readme": [
      "README.md",
      "README_cn.md"
    ]
  },
  "gaps_summary": {
    "critical": [
      "所有模块均缺少单元测试",
      "缺少 API 文档（OpenAPI/Swagger）"
    ],
    "high": [
      "缺少配置文件示例（.env.example）",
      "缺少错误日志记录",
      "缺少请求日志记录"
    ],
    "medium": [
      "缺少 Makefile",
      "缺少 golangci-lint 配置",
      "缺少 CI/CD 测试流程"
    ],
    "low": [
      "缺少性能基准测试",
      "缺少开发者指南",
      "缺少 Docker Compose 开发环境配置"
    ]
  },
  "recommendations": {
    "immediate": [
      "为所有模块添加单元测试",
      "创建 .env.example 配置示例",
      "添加 Makefile 简化开发流程",
      "添加请求/错误日志中间件"
    ],
    "short_term": [
      "添加 API 文档（OpenAPI 规范）",
      "配置 golangci-lint 进行代码质量检查",
      "添加 CI/CD 测试流程",
      "实现优雅关闭机制"
    ],
    "long_term": [
      "添加性能基准测试",
      "实现数据备份和恢复功能",
      "添加监控和指标收集",
      "考虑支持数据库存储（SQLite/PostgreSQL）"
    ]
  },
  "next_steps": [
    {
      "priority": "high",
      "action": "添加单元测试",
      "target": "所有模块",
      "description": "为 crypto、storage、handlers 模块编写单元测试"
    },
    {
      "priority": "high",
      "action": "添加配置文件",
      "target": "项目根目录",
      "description": "创建 .env.example 和 config.yaml.example"
    },
    {
      "priority": "medium",
      "action": "添加构建工具",
      "target": "项目根目录",
      "description": "创建 Makefile 包含 build、test、run 等命令"
    },
    {
      "priority": "medium",
      "action": "添加日志系统",
      "target": "cmd/cookiecloud",
      "description": "集成结构化日志库（如 logrus 或 zap）"
    }
  ]
}
